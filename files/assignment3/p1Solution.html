<!DOCTYPE html
PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <!--
        This HTML was auto-generated from MATLAB code.
        To make changes, update the MATLAB code and republish this document.
        -->
    <title>Assignment 3 Problem 1</title>
    <meta name="generator" content="MATLAB 9.8">
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
    <meta name="DC.date" content="2020-04-18">
    <meta name="DC.source" content="p1Solution.m">
    <style type="text/css">
    html,
    body,
    div,
    span,
    applet,
    object,
    iframe,
    h1,
    h2,
    h3,
    h4,
    h5,
    h6,
    p,
    blockquote,
    pre,
    a,
    abbr,
    acronym,
    address,
    big,
    cite,
    code,
    del,
    dfn,
    em,
    font,
    img,
    ins,
    kbd,
    q,
    s,
    samp,
    small,
    strike,
    strong,
    sub,
    sup,
    tt,
    var,
    b,
    u,
    i,
    center,
    dl,
    dt,
    dd,
    ol,
    ul,
    li,
    fieldset,
    form,
    label,
    legend,
    table,
    caption,
    tbody,
    tfoot,
    thead,
    tr,
    th,
    td {
        margin: 0;
        padding: 0;
        border: 0;
        outline: 0;
        font-size: 100%;
        vertical-align: baseline;
        background: transparent
    }

    body {
        line-height: 1
    }

    ol,
    ul {
        list-style: none
    }

    blockquote,
    q {
        quotes: none
    }

    blockquote:before,
    blockquote:after,
    q:before,
    q:after {
        content: '';
        content: none
    }

    :focus {
        outine: 0
    }

    ins {
        text-decoration: none
    }

    del {
        text-decoration: line-through
    }

    table {
        border-collapse: collapse;
        border-spacing: 0
    }

    html {
        min-height: 100%;
        margin-bottom: 1px;
    }

    html body {
        height: 100%;
        margin: 0px;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 10px;
        color: #000;
        line-height: 140%;
        background: #fff none;
        overflow-y: scroll;
    }

    html body td {
        vertical-align: top;
        text-align: left;
    }

    h1 {
        padding: 0px;
        margin: 0px 0px 25px;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 1.5em;
        color: #d55000;
        line-height: 100%;
        font-weight: normal;
    }

    h2 {
        padding: 0px;
        margin: 0px 0px 8px;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 1.2em;
        color: #000;
        font-weight: bold;
        line-height: 140%;
        border-bottom: 1px solid #d6d4d4;
        display: block;
    }

    h3 {
        padding: 0px;
        margin: 0px 0px 5px;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 1.1em;
        color: #000;
        font-weight: bold;
        line-height: 140%;
    }

    a {
        color: #005fce;
        text-decoration: none;
    }

    a:hover {
        color: #005fce;
        text-decoration: underline;
    }

    a:visited {
        color: #004aa0;
        text-decoration: none;
    }

    p {
        padding: 0px;
        margin: 0px 0px 20px;
    }

    img {
        padding: 0px;
        margin: 0px 0px 20px;
        border: none;
    }

    p img,
    pre img,
    tt img,
    li img,
    h1 img,
    h2 img {
        margin-bottom: 0px;
    }

    ul {
        padding: 0px;
        margin: 0px 0px 20px 23px;
        list-style: square;
    }

    ul li {
        padding: 0px;
        margin: 0px 0px 7px 0px;
    }

    ul li ul {
        padding: 5px 0px 0px;
        margin: 0px 0px 7px 23px;
    }

    ul li ol li {
        list-style: decimal;
    }

    ol {
        padding: 0px;
        margin: 0px 0px 20px 0px;
        list-style: decimal;
    }

    ol li {
        padding: 0px;
        margin: 0px 0px 7px 23px;
        list-style-type: decimal;
    }

    ol li ol {
        padding: 5px 0px 0px;
        margin: 0px 0px 7px 0px;
    }

    ol li ol li {
        list-style-type: lower-alpha;
    }

    ol li ul {
        padding-top: 7px;
    }

    ol li ul li {
        list-style: square;
    }

    .content {
        font-size: 1.2em;
        line-height: 140%;
        padding: 20px;
    }

    pre,
    code {
        font-size: 12px;
    }

    tt {
        font-size: 1.2em;
    }

    pre {
        margin: 0px 0px 20px;
    }

    pre.codeinput {
        padding: 10px;
        border: 1px solid #d3d3d3;
        background: #f7f7f7;
    }

    pre.codeoutput {
        padding: 10px 11px;
        margin: 0px 0px 20px;
        color: #4c4c4c;
    }

    pre.error {
        color: red;
    }

    @media print {

        pre.codeinput,
        pre.codeoutput {
            word-wrap: break-word;
            width: 100%;
        }
    }

    span.keyword {
        color: #0000FF
    }

    span.comment {
        color: #228B22
    }

    span.string {
        color: #A020F0
    }

    span.untermstring {
        color: #B20000
    }

    span.syscmd {
        color: #B28C00
    }

    span.typesection {
        color: #A0522D
    }

    .footer {
        width: auto;
        padding: 10px 0px;
        margin: 25px 0px 0px;
        border-top: 1px dotted #878787;
        font-size: 0.8em;
        line-height: 140%;
        font-style: italic;
        color: #878787;
        text-align: left;
        float: none;
    }

    .footer p {
        margin: 0px;
    }

    .footer a {
        color: #878787;
    }

    .footer a:hover {
        color: #878787;
        text-decoration: underline;
    }

    .footer a:visited {
        color: #878787;
    }

    table th {
        padding: 7px 5px;
        text-align: left;
        vertical-align: middle;
        border: 1px solid #d6d4d4;
        font-weight: bold;
    }

    table td {
        padding: 7px 5px;
        text-align: left;
        vertical-align: top;
        border: 1px solid #d6d4d4;
    }
    </style>


</head>

<body>
    <div class="content">
        <h1>Assignment 3 Problem 1</h1>
        <!--introduction-->
        <pre>Missile intercepting a non-maneuvering target with Pure Proportional Navigation.</pre>
        <!--/introduction-->
        <h2>Contents</h2>
        <div>
            <ul>
                <li><a href="#1">Equations of Motion</a></li>
                <li><a href="#4">Case 1: N = 3, alpha_M0 = 0 deg</a></li>
                <li><a href="#5">Case 2: N = 3, alpha_M0 = 60 deg</a></li>
                <li><a href="#6">Case 3: N = 5, alpha_M0 = 0 deg</a></li>
                <li><a href="#7">Case 4: N = 5, alpha_M0 = 60 deg</a></li>
                <li><a href="#8">Case 5: N = 10, alpha_M0 = 0 deg</a></li>
                <li><a href="#9">Case 6: N = 10, alpha_M0 = 60 deg</a></li>
            </ul>
        </div>
        <h2 id="1">Equations of Motion</h2>
        <p><img src="p1Solution_eq17880495234194005043.png" alt="$$ \dot{R} = V_T \cdot cos(\alpha_T - \theta) - V_M \cdot cos(\alpha_M - \theta) $$"></p>
        <p><img src="p1Solution_eq09315499991472904615.png" alt="$$ \dot{\theta} = \frac{V_T \cdot sin(\alpha_T - \theta) - V_M \cdot sin(\alpha_M - \theta)}{R} $$"></p>
        <p>
            <h1> Solutions of all cases and data generation. </h1>
        </p>
        <pre class="codeinput"><span class="comment">% Setup plot settings</span>
        clear;
        set(groot, <span class="string">'DefaultFigureVisible'</span>, <span class="string">'off'</span>, <span class="string">'DefaultFigureWindowStyle'</span>, <span class="string">'normal'</span>, <span class="string">'DefaultFigureWindowState'</span>, <span class="string">'maximized'</span>);
        plots.gains = [3, 5, 10]; plots.launch_angles = [0, deg2rad(60)]; plots.comp = 4;
        plots.numOfPlots = numel(plots.gains) * numel(plots.launch_angles) *  plots.comp;
        plots.fig = gobjects(plots.numOfPlots, 1);
        index = 1; runcase = 1;
        missdistance = cell(4, 1);
        <span class="comment">% Setup problem conditions</span>
        Vm = 500; Vt = 300; <span class="comment">% m/s</span>
        R0 = 10000; Th0 = deg2rad(60);
        simTime = [0, 50];
        solverOptions =  odeset(<span class="string">'Event'</span>, @terminate_intg, <span class="string">'AbsTol'</span>, 1.0e-8, <span class="string">'RelTol'</span>, 1.0e-6, <span class="string">'Refine'</span>, 5);
        <span class="keyword">for</span> N = each(plots.gains)
            <span class="keyword">for</span> alM0 = each(plots.launch_angles)
                <span class="comment">% 1.0) Solution of Equations of Motion =================================================================</span>
                initCond = [R0; Th0; alM0; 0; 0; R0 * cos(Th0); R0 * sin(Th0)];
                [tsol, ysol, evT, evS, seq] = ode45(@(t, y) p1state(t, y, N, Vm, Vt), simTime, initCond, solverOptions);
                <span class="comment">% Parameter calculations</span>
                ThetaDot = (Vt .* sin(-ysol(:, 2)) - Vm .* sin(ysol(:, 3) - ysol(:, 2))) ./ ysol(:, 1);
                Theta = ysol(:, 2); ThetaDeg = rad2deg(Theta);
                AlphaM = ysol(:, 3);
                K = Vm/Vt;
                Vr = cos(-Theta) - K .* cos(AlphaM - Theta);
                Vtheta = sin(-Theta) - K .* sin(AlphaM - Theta);
                Am = N .* Vm .* ThetaDot; <span class="comment">% lateral acceleration</span>
                <span class="comment">% 1.1) Vehicle Trajectories with LOS Shots =================================================================</span>
                plotname = sprintf(<span class="string">'Trajectories for N = %d, alphaM0 = %4.3f'</span>, N, rad2deg(alM0));
                plots.fig(index) = figure;
                plots.fig(index).Name = plotname; plots.fig(index).Color = <span class="string">'white'</span>;
                hold <span class="string">on</span>;
                p1 = plot(ysol(:, 4), ysol(:, 5), <span class="string">'r'</span>, <span class="string">'LineWidth'</span>, 2); <span class="comment">% Missile Trajectory: Xm and Ym</span>
                p2 = plot(ysol(:, 6), ysol(:, 7), <span class="string">'g'</span>, <span class="string">'LineWidth'</span>, 2); <span class="comment">% Target Trajectory: Xt and Yt</span>
                <span class="comment">% LOS shots</span>
                p3 = line([ysol(1, 4), ysol(1, 6)], [ysol(1, 5), ysol(1, 7)], <span class="string">'Color'</span>, <span class="string">'blue'</span>, <span class="string">'LineStyle'</span>, <span class="string">':'</span>, <span class="string">'Marker'</span>, <span class="string">'.'</span>,  <span class="string">'MarkerEdgeColor'</span>, <span class="string">'blue'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'none'</span>);
                <span class="keyword">for</span> iter = 1:length(ysol(:, 4))
                    <span class="keyword">if</span>(mod(iter, 10) == 0)
                        line([ysol(iter, 4), ysol(iter, 6)], [ysol(iter, 5), ysol(iter, 7)],  <span class="string">'Color'</span>, <span class="string">'blue'</span>, <span class="string">'LineStyle'</span>, <span class="string">':'</span>,<span class="string">'Marker'</span>, <span class="string">'.'</span>, <span class="string">'MarkerEdgeColor'</span>, <span class="string">'blue'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'none'</span>);
                    <span class="keyword">end</span>
                <span class="keyword">end</span>
                hold <span class="string">off</span>;
                title(plotname);
                xlabel(<span class="string">'Downrange (metres)'</span>);
                ylabel(<span class="string">'Altitude (metres)'</span>);
                legend([p1, p2, p3], {<span class="string">'Missile Trajectory'</span>, <span class="string">'Target Trajectory'</span>, <span class="string">'Line-Of-Sight'</span>}, <span class="string">'Location'</span>, <span class="string">'best'</span>);
                grid <span class="string">on</span>; grid <span class="string">minor</span>;
                <span class="comment">% 1.2) Lateral Acceleration profile =================================================================</span>
                plotname = sprintf(<span class="string">'Am for N = %d, alphaM0 = %4.3f'</span>, N, rad2deg(alM0));
                plots.fig(index + 1) = figure;
                plots.fig(index + 1).Name = plotname; plots.fig(index + 1).Color = <span class="string">'white'</span>;
                plot(tsol(:), Am(:));
                title(plotname);
                xlabel(<span class="string">'Time instant of engagement (sec)'</span>);
                ylabel(<span class="string">'Magnitude of Lateral Acceleration $(m/s^2)$'</span>);
                <span class="comment">% 1.3) Vtheta - Vr trajectories =================================================================</span>
                plots.fig(index + 2) = figure;
                plots.fig(index + 2).Name = <span class="string">'Trajectory Space'</span>; plots.fig(index + 2).Color = <span class="string">'white'</span>;
                title(<span class="string">'$V_{r}(t)-V_{\theta}(t)$ Trajectory Space'</span>, <span class="string">'Interpreter'</span>,<span class="string">'latex'</span>)
                subplot(2, 1, 1);
                plot(ThetaDeg, Vr, <span class="string">'LineWidth'</span>, 2);
                text([ThetaDeg(1) - 0.2, ThetaDeg(end) - 0.004], [Vr(1) - 0.05, Vr(end) - 0.12], {[<span class="string">'time: '</span>, num2str(tsol(1))], [<span class="string">'time: '</span>, num2str(tsol(end))]});
                xlabel(<span class="string">'$\theta(t)$'</span>, <span class="string">'Interpreter'</span>,<span class="string">'latex'</span>);
                ylabel(<span class="string">'$v_{r}(t)$'</span>, <span class="string">'Interpreter'</span>,<span class="string">'latex'</span>);
                xlim([min(ThetaDeg) - 0.005 * min(ThetaDeg), max(ThetaDeg)]);
                ylim([min(Vr) + 0.25 * min(Vr), 0.05]);
                grid <span class="string">on</span>; grid <span class="string">minor</span>;
                ax = gca;
                ax.XAxisLocation = <span class="string">'origin'</span>;
                ax.YAxisLocation = <span class="string">'origin'</span>;
                subplot(2, 1, 2);
                plot(ThetaDeg, Vtheta, <span class="string">'LineWidth'</span>, 2);
                xlabel(<span class="string">'$\theta(t)$'</span>, <span class="string">'Interpreter'</span>,<span class="string">'latex'</span>);
                ylabel(<span class="string">'$v_{\theta}(t)$'</span>, <span class="string">'Interpreter'</span>,<span class="string">'latex'</span>);
                xlim([min(ThetaDeg) - 0.005 * min(ThetaDeg), max(ThetaDeg)]);
                text([ThetaDeg(1) - 0.2, ThetaDeg(end)], [Vtheta(1) - 0.06, Vtheta(end) - 0.15], {[<span class="string">'time: '</span>, num2str(tsol(1))], [<span class="string">'time: '</span>, num2str(tsol(end))]});
                grid <span class="string">on</span>; grid <span class="string">minor</span>;
                ax = gca;
                ax.XAxisLocation = <span class="string">'origin'</span>;
                ax.YAxisLocation = <span class="string">'origin'</span>;
                <span class="comment">% 1.4) Parameter Variations =================================================================</span>
                plots.fig(index + 3) = figure;
                plots.fig(index + 3).Name = <span class="string">'Results'</span>; plots.fig(index + 3).Color = <span class="string">'white'</span>;
                missdistance{runcase} = sprintf(<span class="string">'Miss Distance = %4.3f'</span>, min(ysol(:, 1)));
                subplot(2, 2, 1);
                plot(tsol, ysol(:, 1));
                xlabel(<span class="string">'Time in sec'</span>);
                ylabel(<span class="string">'metres'</span>);
                title(<span class="string">'LOS Separation R'</span>, <span class="string">'Interpreter'</span>, <span class="string">'latex'</span>);
                grid <span class="string">on</span>; grid <span class="string">minor</span>;
                subplot(2, 2, 2);
                plot(tsol, rad2deg(AlphaM));
                xlabel(<span class="string">'Time in sec'</span>);
                ylabel(<span class="string">'degrees'</span>);
                title(<span class="string">'Missile Heading $\alpha_M$'</span>, <span class="string">'Interpreter'</span>, <span class="string">'latex'</span>);
                grid <span class="string">on</span>; grid <span class="string">minor</span>;
                subplot(2, 2, 3);
                plot(tsol, rad2deg(Theta));
                xlabel(<span class="string">'Time in sec'</span>);
                ylabel(<span class="string">'degrees'</span>);
                title(<span class="string">'LOS Angle $\theta$'</span>, <span class="string">'Interpreter'</span>, <span class="string">'latex'</span>);
                grid <span class="string">on</span>; grid <span class="string">minor</span>;
                subplot(2, 2, 4);
                plot(tsol, rad2deg(ThetaDot));
                xlabel(<span class="string">'Time in sec'</span>);
                title(<span class="string">'LOS Angular Rate $\dot{\theta}$'</span>, <span class="string">'Interpreter'</span>, <span class="string">'latex'</span>);
                grid <span class="string">on</span>; grid <span class="string">minor</span>;
                <span class="comment">% increment plot index to next block</span>
                index = index + 4;
                runcase = runcase + 1;
            <span class="keyword">end</span>
        <span class="keyword">end</span>
    </pre>
        <p>
            <h1> Plots of all cases </h1>
        </p>
        <h2 id="4">Case 1: N = 3, alpha_M0 = 0 deg</h2>
        <p><img src="p1Solution_eq17442150479020634065.png" alt="$$ N = 3, \alpha_{M0} = 0^{o}$$"></p>
        <pre class="codeinput">fprintf(missdistance{1});
        index = 1;
        plots.fig(index).Visible = <span class="string">'on'</span>;
        plots.fig(index + 1).Visible = <span class="string">'on'</span>;
        plots.fig(index + 2).Visible = <span class="string">'on'</span>;
        plots.fig(index + 3).Visible = <span class="string">'on'</span>;
        snapnow;
        index = index + 4;
    </pre>
        <pre class="codeoutput">Miss Distance = 0.100</pre><img vspace="5" hspace="5" src="p1Solution_01.png" alt=""> <img vspace="5" hspace="5" src="p1Solution_02.png" alt=""> <img vspace="5" hspace="5" src="p1Solution_03.png" alt=""> <img vspace="5" hspace="5" src="p1Solution_04.png" alt="">
        <h2 id="5">Case 2: N = 3, alpha_M0 = 60 deg</h2>
        <p><img src="p1Solution_eq00471659179296178263.png" alt="$$ N = 3, \alpha_{M0} = 60^{o}$$"></p>
        <pre class="codeinput">fprintf(missdistance{2});
    plots.fig(index).Visible = <span class="string">'on'</span>;
    plots.fig(index + 1).Visible = <span class="string">'on'</span>;
    plots.fig(index + 2).Visible = <span class="string">'on'</span>;
    plots.fig(index + 3).Visible = <span class="string">'on'</span>;
    snapnow;
    index = index + 4;
</pre>
        <pre class="codeoutput">Miss Distance = 0.100</pre><img vspace="5" hspace="5" src="p1Solution_05.png" alt=""> <img vspace="5" hspace="5" src="p1Solution_06.png" alt=""> <img vspace="5" hspace="5" src="p1Solution_07.png" alt=""> <img vspace="5" hspace="5" src="p1Solution_08.png" alt="">
        <h2 id="6">Case 3: N = 5, alpha_M0 = 0 deg</h2>
        <p><img src="p1Solution_eq05680046082899360874.png" alt="$$ N = 5, \alpha_{M0} = 0^{o}$$"></p>
        <pre class="codeinput">fprintf(missdistance{3});
plots.fig(index).Visible = <span class="string">'on'</span>;
plots.fig(index + 1).Visible = <span class="string">'on'</span>;
plots.fig(index + 2).Visible = <span class="string">'on'</span>;
plots.fig(index + 3).Visible = <span class="string">'on'</span>;
snapnow;
index = index + 4;
</pre>
        <pre class="codeoutput">Miss Distance = 0.100</pre><img vspace="5" hspace="5" src="p1Solution_09.png" alt=""> <img vspace="5" hspace="5" src="p1Solution_10.png" alt=""> <img vspace="5" hspace="5" src="p1Solution_11.png" alt=""> <img vspace="5" hspace="5" src="p1Solution_12.png" alt="">
        <h2 id="7">Case 4: N = 5, alpha_M0 = 60 deg</h2>
        <p><img src="p1Solution_eq12284461038078084878.png" alt="$$ N = 5, \alpha_{M0} = 60^{o}$$"></p>
        <pre class="codeinput">fprintf(missdistance{4});
plots.fig(index).Visible = <span class="string">'on'</span>;
plots.fig(index + 1).Visible = <span class="string">'on'</span>;
plots.fig(index + 2).Visible = <span class="string">'on'</span>;
plots.fig(index + 3).Visible = <span class="string">'on'</span>;
snapnow;
index = index + 4;
</pre>
        <pre class="codeoutput">Miss Distance = 0.100</pre><img vspace="5" hspace="5" src="p1Solution_13.png" alt=""> <img vspace="5" hspace="5" src="p1Solution_14.png" alt=""> <img vspace="5" hspace="5" src="p1Solution_15.png" alt=""> <img vspace="5" hspace="5" src="p1Solution_16.png" alt="">
        <h2 id="8">Case 5: N = 10, alpha_M0 = 0 deg</h2>
        <p><img src="p1Solution_eq11640179809065112696.png" alt="$$ N = 10, \alpha_{M0} = 0^{o}$$"></p>
        <pre class="codeinput">fprintf(missdistance{5});
plots.fig(index).Visible = <span class="string">'on'</span>;
plots.fig(index + 1).Visible = <span class="string">'on'</span>;
plots.fig(index + 2).Visible = <span class="string">'on'</span>;
plots.fig(index + 3).Visible = <span class="string">'on'</span>;
snapnow;
index = index + 4;
</pre>
        <pre class="codeoutput">Miss Distance = 0.100</pre><img vspace="5" hspace="5" src="p1Solution_17.png" alt=""> <img vspace="5" hspace="5" src="p1Solution_18.png" alt=""> <img vspace="5" hspace="5" src="p1Solution_19.png" alt=""> <img vspace="5" hspace="5" src="p1Solution_20.png" alt="">
        <h2 id="9">Case 6: N = 10, alpha_M0 = 60 deg</h2>
        <p><img src="p1Solution_eq10045706261352794666.png" alt="$$ N = 10, \alpha_{M0} = 60^{o}$$"></p>
        <pre class="codeinput">fprintf(missdistance{6});
plots.fig(index).Visible = <span class="string">'on'</span>;
plots.fig(index + 1).Visible = <span class="string">'on'</span>;
plots.fig(index + 2).Visible = <span class="string">'on'</span>;
plots.fig(index + 3).Visible = <span class="string">'on'</span>;
snapnow;
index = index + 4;
</pre>
        <pre class="codeoutput">Miss Distance = 0.100</pre><img vspace="5" hspace="5" src="p1Solution_21.png" alt=""> <img vspace="5" hspace="5" src="p1Solution_22.png" alt=""> <img vspace="5" hspace="5" src="p1Solution_23.png" alt=""> <img vspace="5" hspace="5" src="p1Solution_24.png" alt="">
        <p>
            <h3> Perform Cleanup Tasks </h3>
        </p>
        <pre class="codeinput">close <span class="string">all</span>;
clear;
set(groot, <span class="string">'DefaultFigureVisible'</span>, <span class="string">'on'</span>);
</pre>
        <p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020a</a><br></p>
    </div>
    <!--
##### SOURCE BEGIN #####
%% Assignment 3 Problem 1
%  Missile intercepting a non-maneuvering target with Pure Proportional Navigation.
%% Equations of Motion
%
% $$ \dot{R} = V_T \cdot cos(\alpha_T - \theta) - V_M \cdot cos(\alpha_M - \theta) $$
%
% $$ \dot{\theta} = \frac{V_T \cdot sin(\alpha_T - \theta) - V_M \cdot sin(\alpha_M - \theta)}{R} $$
%
%%
%
% <html>
% <h1> Solutions of all cases and data generation. </h1>
% </html>
%
% Setup plot settings
clear;
set(groot, 'DefaultFigureVisible', 'off', 'DefaultFigureWindowStyle', 'normal', 'DefaultFigureWindowState', 'maximized');
plots.gains = [3, 5, 10]; plots.launch_angles = [0, deg2rad(60)]; plots.comp = 4;
plots.numOfPlots = numel(plots.gains) * numel(plots.launch_angles) *  plots.comp;
plots.fig = gobjects(plots.numOfPlots, 1);
index = 1; runcase = 1;
missdistance = cell(4, 1);
% Setup problem conditions
Vm = 500; Vt = 300; % m/s
R0 = 10000; Th0 = deg2rad(60);
simTime = [0, 50];
solverOptions =  odeset('Event', @terminate_intg, 'AbsTol', 1.0e-8, 'RelTol', 1.0e-6, 'Refine', 5);
for N = each(plots.gains)
for alM0 = each(plots.launch_angles)
% 1.0) Solution of Equations of Motion =================================================================
initCond = [R0; Th0; alM0; 0; 0; R0 * cos(Th0); R0 * sin(Th0)];
[tsol, ysol, evT, evS, seq] = ode45(@(t, y) p1state(t, y, N, Vm, Vt), simTime, initCond, solverOptions);
% Parameter calculations
ThetaDot = (Vt .* sin(-ysol(:, 2)) - Vm .* sin(ysol(:, 3) - ysol(:, 2))) ./ ysol(:, 1);
Theta = ysol(:, 2); ThetaDeg = rad2deg(Theta);
AlphaM = ysol(:, 3);
K = Vm/Vt;
Vr = cos(-Theta) - K .* cos(AlphaM - Theta);
Vtheta = sin(-Theta) - K .* sin(AlphaM - Theta);
Am = N .* Vm .* ThetaDot; % lateral acceleration
% 1.1) Vehicle Trajectories with LOS Shots =================================================================
plotname = sprintf('Trajectories for N = %d, alphaM0 = %4.3f', N, rad2deg(alM0));
plots.fig(index) = figure;
plots.fig(index).Name = plotname; plots.fig(index).Color = 'white';
hold on;
p1 = plot(ysol(:, 4), ysol(:, 5), 'r', 'LineWidth', 2); % Missile Trajectory: Xm and Ym
p2 = plot(ysol(:, 6), ysol(:, 7), 'g', 'LineWidth', 2); % Target Trajectory: Xt and Yt
% LOS shots
p3 = line([ysol(1, 4), ysol(1, 6)], [ysol(1, 5), ysol(1, 7)], 'Color', 'blue', 'LineStyle', ':', 'Marker', '.',  'MarkerEdgeColor', 'blue', 'MarkerFaceColor', 'none');
for iter = 1:length(ysol(:, 4))
if(mod(iter, 10) == 0)
line([ysol(iter, 4), ysol(iter, 6)], [ysol(iter, 5), ysol(iter, 7)],  'Color', 'blue', 'LineStyle', ':','Marker', '.', 'MarkerEdgeColor', 'blue', 'MarkerFaceColor', 'none');
end
end
hold off;
title(plotname);
xlabel('Downrange (metres)');
ylabel('Altitude (metres)');
legend([p1, p2, p3], {'Missile Trajectory', 'Target Trajectory', 'Line-Of-Sight'}, 'Location', 'best');
grid on; grid minor;
% 1.2) Lateral Acceleration profile =================================================================
plotname = sprintf('Am for N = %d, alphaM0 = %4.3f', N, rad2deg(alM0));
plots.fig(index + 1) = figure;
plots.fig(index + 1).Name = plotname; plots.fig(index + 1).Color = 'white';
plot(tsol(:), Am(:));
title(plotname);
xlabel('Time instant of engagement (sec)');
ylabel('Magnitude of Lateral Acceleration $(m/s^2)$');
% 1.3) Vtheta - Vr trajectories =================================================================
plots.fig(index + 2) = figure;
plots.fig(index + 2).Name = 'Trajectory Space'; plots.fig(index + 2).Color = 'white';
title('$V_{r}(t)-V_{\theta}(t)$ Trajectory Space', 'Interpreter','latex')
subplot(2, 1, 1);
plot(ThetaDeg, Vr, 'LineWidth', 2);
text([ThetaDeg(1) - 0.2, ThetaDeg(end) - 0.004], [Vr(1) - 0.05, Vr(end) - 0.12], {['time: ', num2str(tsol(1))], ['time: ', num2str(tsol(end))]});
xlabel('$\theta(t)$', 'Interpreter','latex');
ylabel('$v_{r}(t)$', 'Interpreter','latex');
xlim([min(ThetaDeg) - 0.005 * min(ThetaDeg), max(ThetaDeg)]);
ylim([min(Vr) + 0.25 * min(Vr), 0.05]);
grid on; grid minor;
ax = gca;
ax.XAxisLocation = 'origin';
ax.YAxisLocation = 'origin';
subplot(2, 1, 2);
plot(ThetaDeg, Vtheta, 'LineWidth', 2);
xlabel('$\theta(t)$', 'Interpreter','latex');
ylabel('$v_{\theta}(t)$', 'Interpreter','latex');
xlim([min(ThetaDeg) - 0.005 * min(ThetaDeg), max(ThetaDeg)]);
text([ThetaDeg(1) - 0.2, ThetaDeg(end)], [Vtheta(1) - 0.06, Vtheta(end) - 0.15], {['time: ', num2str(tsol(1))], ['time: ', num2str(tsol(end))]});
grid on; grid minor;
ax = gca;
ax.XAxisLocation = 'origin';
ax.YAxisLocation = 'origin';
% 1.4) Parameter Variations =================================================================
plots.fig(index + 3) = figure;
plots.fig(index + 3).Name = 'Results'; plots.fig(index + 3).Color = 'white';
missdistance{runcase} = sprintf('Miss Distance = %4.3f', min(ysol(:, 1)));
subplot(2, 2, 1);
plot(tsol, ysol(:, 1));
xlabel('Time in sec');
ylabel('metres');
title('LOS Separation R', 'Interpreter', 'latex');
grid on; grid minor;
subplot(2, 2, 2);
plot(tsol, rad2deg(AlphaM));
xlabel('Time in sec');
ylabel('degrees');
title('Missile Heading $\alpha_M$', 'Interpreter', 'latex');
grid on; grid minor;
subplot(2, 2, 3);
plot(tsol, rad2deg(Theta));
xlabel('Time in sec');
ylabel('degrees');
title('LOS Angle $\theta$', 'Interpreter', 'latex');
grid on; grid minor;
subplot(2, 2, 4);
plot(tsol, rad2deg(ThetaDot));
xlabel('Time in sec');
title('LOS Angular Rate $\dot{\theta}$', 'Interpreter', 'latex');
grid on; grid minor;
% increment plot index to next block
index = index + 4;
runcase = runcase + 1;
end
end
%%
%
% <html>
% <h1> Plots of all cases </h1>
% </html>
%
%% Case 1: N = 3, alpha_M0 = 0 deg
%
% $$ N = 3, \alpha_{M0} = 0^{o}$$
%
fprintf(missdistance{1});
index = 1;
plots.fig(index).Visible = 'on';
plots.fig(index + 1).Visible = 'on';
plots.fig(index + 2).Visible = 'on';
plots.fig(index + 3).Visible = 'on';
snapnow;
index = index + 4;
%% Case 2: N = 3, alpha_M0 = 60 deg
%
% $$ N = 3, \alpha_{M0} = 60^{o}$$
%
fprintf(missdistance{2});
plots.fig(index).Visible = 'on';
plots.fig(index + 1).Visible = 'on';
plots.fig(index + 2).Visible = 'on';
plots.fig(index + 3).Visible = 'on';
snapnow;
index = index + 4;
%% Case 3: N = 5, alpha_M0 = 0 deg
%
% $$ N = 5, \alpha_{M0} = 0^{o}$$
%
fprintf(missdistance{3});
plots.fig(index).Visible = 'on';
plots.fig(index + 1).Visible = 'on';
plots.fig(index + 2).Visible = 'on';
plots.fig(index + 3).Visible = 'on';
snapnow;
index = index + 4;
%% Case 4: N = 5, alpha_M0 = 60 deg
%
% $$ N = 5, \alpha_{M0} = 60^{o}$$
%
fprintf(missdistance{4});
plots.fig(index).Visible = 'on';
plots.fig(index + 1).Visible = 'on';
plots.fig(index + 2).Visible = 'on';
plots.fig(index + 3).Visible = 'on';
snapnow;
index = index + 4;
%% Case 5: N = 10, alpha_M0 = 0 deg
%
% $$ N = 10, \alpha_{M0} = 0^{o}$$
%
fprintf(missdistance{5});
plots.fig(index).Visible = 'on';
plots.fig(index + 1).Visible = 'on';
plots.fig(index + 2).Visible = 'on';
plots.fig(index + 3).Visible = 'on';
snapnow;
index = index + 4;
%% Case 6: N = 10, alpha_M0 = 60 deg
%
% $$ N = 10, \alpha_{M0} = 60^{o}$$
%
fprintf(missdistance{6});
plots.fig(index).Visible = 'on';
plots.fig(index + 1).Visible = 'on';
plots.fig(index + 2).Visible = 'on';
plots.fig(index + 3).Visible = 'on';
snapnow;
index = index + 4;
%%
%
% <html>
% <h3> Perform Cleanup Tasks </h3>
% </html>
%
close all;
clear;
set(groot, 'DefaultFigureVisible', 'on');
##### SOURCE END #####
-->
</body>

</html>
